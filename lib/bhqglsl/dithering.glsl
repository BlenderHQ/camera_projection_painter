const float _dither[8][8] = {{0.000000, 0.750000, 0.187500, 0.937500, 0.046875, 0.796875, 0.234375, 0.984375},
{0.500000, 0.250000, 0.687500, 0.437500, 0.546875, 0.296875, 0.734375, 0.484375},
{0.125000, 0.875000, 0.062500, 0.812500, 0.171875, 0.921875, 0.109375, 0.859375},
{0.625000, 0.375000, 0.562500, 0.312500, 0.671875, 0.421875, 0.609375, 0.359375},
{0.031250, 0.781250, 0.218750, 0.968750, 0.015625, 0.765625, 0.203125, 0.953125},
{0.531250, 0.281250, 0.718750, 0.468750, 0.515625, 0.265625, 0.703125, 0.453125},
{0.156250, 0.906250, 0.093750, 0.843750, 0.140625, 0.890625, 0.078125, 0.828125},
{0.656250, 0.406250, 0.593750, 0.343750, 0.640625, 0.390625, 0.578125, 0.328125}};
float _dither8x8(float _luma) {
int x = int(mod(gl_FragCoord.x, 8.0));
int y = int(mod(gl_FragCoord.y, 8.0));
float limit = 0.0;
if (x < 8) {
limit = _dither[x][y];
}
return _luma < limit ? 0.0 : 1.0;
}
vec4 bayer_dither8x8(vec4 color) {
float luma = dot(color.rgb, vec3(0.2126, 0.7152, 0.0722));
return vec4(color.rgb * _dither8x8(luma), color.a);
}